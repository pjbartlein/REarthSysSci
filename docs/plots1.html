<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Plots (1)</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="html-md-01.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R for Earth-System Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture topics</li>
    <li>
      <a href="intro.html">Introduction: R, RStudio, and other infrastructure</a>
    </li>
    <li>
      <a href="usingR.html">Using R</a>
    </li>
    <li>
      <a href="ESSdata.html">Earth-system science data</a>
    </li>
    <li>
      <a href="netCDF.html">netCDF in R</a>
    </li>
    <li>
      <a href="netcdf_terra.html">netCDF and terra</a>
    </li>
    <li>
      <a href="plots1.html">Plots (1)</a>
    </li>
    <li>
      <a href="plots2.html">Plots (2)</a>
    </li>
    <li>
      <a href="maps1.html">Maps (1)</a>
    </li>
    <li>
      <a href="maps2.html">Maps (2)</a>
    </li>
    <li>
      <a href="geospatial.html">Geospatial analyses</a>
    </li>
    <li>
      <a href="correlation.html">Correlation and regression</a>
    </li>
    <li>
      <a href="prediction.html">Prediction</a>
    </li>
    <li>
      <a href="pca.html">PCA</a>
    </li>
    <li>
      <a href="svd.html">Singular Value Decomposistion</a>
    </li>
    <li>
      <a href="highdim.html">High-resolution &amp; high-dimensional data</a>
    </li>
    <li>
      <a href="multivariate.html">Multivariate methods</a>
    </li>
    <li>
      <a href="timeseries.html">Time-series analysis</a>
    </li>
    <li>
      <a href="otherlang.html">Other Languages</a>
    </li>
    <li class="dropdown-header">Other topics</li>
    <li>
      <a href="sf_stars_sftime.html">sf / stars / sftime</a>
    </li>
    <li>
      <a href="hdf5_intro.html">HDF in R</a>
    </li>
    <li>
      <a href="anomalies.html">Long-term means and anomalies</a>
    </li>
    <li>
      <a href="tsplots.html">Time-series plots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tasks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Tasks</li>
    <li>
      <a href="installR.html">Install R and RStudio</a>
    </li>
    <li>
      <a href="Ex_UsingR.html">Using R exercise</a>
    </li>
    <li>
      <a href="install_netCDF.html">Install netCDF &amp; Panoply</a>
    </li>
    <li>
      <a href="transfer.html">File transfer</a>
    </li>
    <li>
      <a href="texteditor.html">Install a text editor</a>
    </li>
    <li>
      <a href="dataselection.html">Project data set selection</a>
    </li>
    <li>
      <a href="markdown.html">Markdown and RMarkdown</a>
    </li>
    <li>
      <a href="scripts_and_md.html">R Scripts and R Markdown</a>
    </li>
    <li>
      <a href="github.html">GitHub</a>
    </li>
    <li>
      <a href="pages.html">pages.uoregon.edu</a>
    </li>
    <li>
      <a href="localweb.html">Local websites</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="readings.html">Readings</a>
    </li>
    <li>
      <a href="websites.html">Old course web pages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Plots (1)</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction"><span
class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#univariate-and-bivariate-plots"
id="toc-univariate-and-bivariate-plots"><span
class="toc-section-number">2</span> Univariate and bivariate plots</a>
<ul>
<li><a href="#simple-plots" id="toc-simple-plots"><span
class="toc-section-number">2.1</span> Simple plots</a></li>
<li><a href="#dotchartsdotplots" id="toc-dotchartsdotplots"><span
class="toc-section-number">2.2</span> Dotcharts/Dotplots</a></li>
<li><a href="#boxplots" id="toc-boxplots"><span
class="toc-section-number">2.3</span> Boxplots</a></li>
<li><a href="#histograms-and-density-plots"
id="toc-histograms-and-density-plots"><span
class="toc-section-number">2.4</span> Histograms and density
plots</a></li>
</ul></li>
<li><a href="#bivariate-plots" id="toc-bivariate-plots"><span
class="toc-section-number">3</span> Bivariate plots</a>
<ul>
<li><a href="#scatter-diagrams" id="toc-scatter-diagrams"><span
class="toc-section-number">3.1</span> Scatter diagrams</a></li>
<li><a href="#summarizing-scatter-plots"
id="toc-summarizing-scatter-plots"><span
class="toc-section-number">3.2</span> Summarizing scatter plots</a></li>
</ul></li>
<li><a href="#multivariate-plots" id="toc-multivariate-plots"><span
class="toc-section-number">4</span> Multivariate plots</a>
<ul>
<li><a href="#labeled-scatter-plots"
id="toc-labeled-scatter-plots"><span
class="toc-section-number">4.1</span> Labeled scatter plots</a></li>
<li><a href="#d-scatter-plots" id="toc-d-scatter-plots"><span
class="toc-section-number">4.2</span> 3-D Scatter plots</a></li>
</ul></li>
<li><a href="#trellislattice-graphics"
id="toc-trellislattice-graphics"><span
class="toc-section-number">5</span> Trellis/Lattice graphics</a>
<ul>
<li><a href="#coplots-conditioning-scatter-plots"
id="toc-coplots-conditioning-scatter-plots"><span
class="toc-section-number">5.1</span> Coplots (conditioning scatter
plots)</a></li>
</ul></li>
<li><a href="#more-lattice-plots" id="toc-more-lattice-plots"><span
class="toc-section-number">6</span> More Lattice Plots</a>
<ul>
<li><a href="#multipanel-plots" id="toc-multipanel-plots"><span
class="toc-section-number">6.1</span> Multipanel plots</a></li>
</ul></li>
</ul>
</div>

<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>
<span style="color: #00cc00;">NOTE: This page has been revised for
Winter 2024, but may undergo further edits.</span>
</p>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>Once data has been retrieved and read in, the first step in any
analysis is to plot or visualize the data: plot first, then model! The
prinicipal plotting and visualization tool for examining Earth-system
science data is, of course, the map, but there are a variety of other
kinds of plots that are useful including time-space maps, or Hovmöller
diagrams. This topic focuses on some of the basic plots for
characterizing data, and contrasts the quick (and dirty) base R plots
with the nicer versions of plots generated by the <code>{ggplot2}</code>
package. The original package was <code>{ggplot}</code>, and was
replaced by. <code>{ggplot2}</code> (although the main function
<code>ggplot()</code> remained the same). The current version of the
package (as of Jan 2024), is 3.4.4, but it’s still called
<code>{ggplot2}</code> (and the main function remains
<code>ggplot()</code>).</p>
<p>The package <code>{ggplot2}</code> by Hadley Wickham (and others)
provides an alternative approach to the “base” graphics in
<strong>R</strong> for constructing plots and maps, and was inspired by
Lee Wilkinson’s <em>The Grammar of Graphics</em> book (Springer, 2nd Ed.
2005). The basic premise of the <em>Grammar of Graphics</em> book, and
of the underlying design of the package, is that data graphics, like a
language, are built upon some basic components that are assembled or
layered on top of one another. In the case of English (e.g Garner, B.,
2016, <em>The Chicago Guide to Grammar, Usage and Punctuation</em>,
Univ. Chicago Press), there are eight “parts of speech” from which
sentences are assembled:</p>
<ul>
<li><em>Nouns</em> (e.g. <em>computer</em>, <em>classroom</em>,
<em>data</em>, …), including gerunds (e.g. <em>readings</em>)</li>
<li><em>Pronouns</em> (e.g. <em>he</em>, <em>she</em>, <em>they</em>,
…)</li>
<li><em>Adjectives</em> (e.g. <em>good</em>, <em>green</em>,
<em>my</em>, <em>year-to-year</em>, …, including articles,
e.g. <em>a</em>, <em>the</em>)</li>
<li><em>Verbs</em> (e.g. <em>analyze</em>, <em>write</em>,
<em>discuss</em>, <em>computing</em>, …)</li>
<li><em>Adverbs</em> (e.g. “-ly” words, <em>very</em>, <em>loudly</em>,
<em>bigly</em>, <em>near</em>, <em>far</em>, …)</li>
<li><em>Prepositions</em> (e.g. <em>on</em>, <em>in</em>, <em>to</em>,
…)</li>
<li><em>Conjunctives</em> (e.g. <em>and</em>, <em>but</em>, …)</li>
<li><em>Interjections</em> (e.g. <em>damn</em>)</li>
</ul>
<p>(but as Garner notes, those categories “aren’t fully settled…”
p. 18).</p>
<p>In the case of graphics (e.g. Wickham, H., 2016, <em>ggplot2 –
Elegant Graphics for Data Analysis, 2nd. Ed.</em>, Springer, available
online from <a
href="http://library.uoregon.edu">[http://library.uoregon.edu]</a>) the
components are:</p>
<ul>
<li><em>Data</em> (e.g. in a dataframe)</li>
<li><em>Coordinate Systems</em> (the coordinate system of a plot)</li>
<li><em>Geoms</em> and their “aesthetic mappings” (the geometric objects
like points, lines, polygons that represent the data)</li>
</ul>
<p>These functions return <em>Layers</em> (made up of geometric
elements) that build up the plot. In addition, plots are composed of</p>
<ul>
<li><em>Stats</em> (or “statistical transformations”, i.e. curves)</li>
<li><em>Scales</em> (that map data into the “aesthetic space”, i.e. axes
and legends)</li>
<li><em>Facets</em> (e.g subsets of data in individual plots)</li>
<li><em>Legends</em> and</li>
<li><em>Themes</em> (that control things like background colors, fonts,
etc.)</li>
</ul>
<p>In describing or characterizing the observations of an individual
variable, there are three basic properties that are of interest:</p>
<ul>
<li>the <em>location</em> of observations (along the number line in
general (but the geographical analogy is obvious), or how large or small
the values of the individual observations are)</li>
<li>the <em>dispersion</em> (sometimes called scale or spread) of the
observations (how spread out they are along the number line, and again
the geographical analogy is obvious)</li>
<li>the <em>distribution</em> of the observations (a characterization of
the frequency of occurrence of different values of the variable–do some
values occurs more frequently than other values?)</li>
</ul>
<p>Univariate plots provide one way to find out about those properties
(and univariate descriptive statistics provide another).</p>
</div>
<div id="univariate-and-bivariate-plots" class="section level1"
number="2">
<h1><span class="header-section-number">2</span> Univariate and
bivariate plots</h1>
<p>There are two basic kinds of univariate, or one-variable-at-a-time
plots,</p>
<ol style="list-style-type: decimal">
<li>Enumerative plots, or plots that show every observation, and</li>
<li>Summary plots, that generalize the data into a simplified
representation.</li>
</ol>
<div id="simple-plots" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Simple plots</h2>
<p>Load the <code>{ggplot2}</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># ggplot2 versions of plots</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Also load some data to reproduce the examples here:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># load data from a saved .RData file</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">url</span>(<span class="st">&quot;https://pages.uoregon.edu/bartlein/RESS/RData/geog490.RData&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span>con) </span></code></pre></div>
<p>We’ll start with plots that are <em>univariate</em> (one variable)
<em>enumerative</em> (all data points shown). (This page is largely
derived from the GEOG 4/595 Geographic Data Analysis page <a
href="https://pjbartlein.github.io/GeogDataAnalysis/">[https://pjbartlein.github.io/GeogDataAnalysis/]</a>.
Enumerative plots, in which all observations are shown, have the
advantage of not losing any specific information–the values of the
individual observations can be retrieved from the plot. The disadvantage
of such plots arises when there are a large number of observations–it
may be difficult to get an overall view of the properties of a variable.
Enumerative plots do a fairly good job of displaying the location,
dispersion and distribution of a variable, but may not allow a clear
comparison of variables, one to another.</p>
<p>Here is the <strong>R</strong> base graphics simple index plot, with
the value of the variable being plotted on the y axis, and the row
number in the data.frame on the x-axis (and note the use of the
<code>attach()</code> function to make the variables available using
just their names, as opposed ot “full names” (e.g. <code>Length</code>
as opposed to <code>sumcr$Length</code>):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># index plot</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">attach</span>(sumcr)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">plot</span>(Length)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-4-1.png" width="80%" height="80%" /></p>
<p>Here’s the <code>{ggplot2}</code> version of the same plot. The code
is longer, but the additions allow for greater control, with the plot
being built up in layers. The easiest way to see how the plots work is
to comment out one or more lines (after the first) to see how the plots
work.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># ggplot version</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> sumcr, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sumcr), <span class="at">y =</span> Length)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sumcr), <span class="at">y =</span> Length)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Summit Cr.&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Observation&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Length (m)&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-5-1.png" width="80%" height="80%" /></p>
<p>Another common univariate enumerative plot is the the strip plot /
chart, plain and stacked:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># stripchart</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">stripchart</span>(Length)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-6-1.png" width="80%" height="80%" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">stripchart</span>(Length, <span class="at">method=</span><span class="st">&quot;stack&quot;</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-6-2.png" width="80%" height="80%" /></p>
<p>The full <code>{ggplot2}</code> version almost reproduces the
base-graphics version. Note the use of the <code>aes()</code>
(aesthetic) function for describing the basic plot, which then has the
dotplot added using the <code>geom_dotplot()</code> function. The
<code>theme_bw()</code> term specifies the simple black-and-white theme.
As in the case of a histogram, the <code>binwidth</code> parameter
controls the granularity of the plot, and <code>coord_fixed()</code>
function changes the aspect ratio of the plot. (The white space can be
cropped when saving the image.)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># ggplot stripchart</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sumcr, <span class="fu">aes</span>(<span class="at">x =</span> Length)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binwidth =</span> <span class="fl">0.25</span>, <span class="at">method =</span> <span class="st">&quot;histodot&quot;</span>) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="fl">4.0</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-7-1.png" width="80%" height="80%" /></p>
<p>Note that the whitespace could be removed after saving the
figure.</p>
</div>
<div id="dotchartsdotplots" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span>
Dotcharts/Dotplots</h2>
<p>“Cleveland-style” dot charts are named after their inventor, William
S. Cleveland, who wrote a couple of influential books on datea
visualization, and participated in the development of S at Bell Labs.
They were designed as an antidote to bar and pie charts, which are
notorious for their poor performance in delivering information. Here’s a
base-graphics Cleveland-style dotchart.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Cleveland-style dot charts</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">dotchart</span>(WidthWS, <span class="at">labels=</span><span class="fu">as.character</span>(Location), <span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-8-1.png" width="80%" height="80%" /></p>
<p>… and the <code>{ggplot2}</code> equivalent:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Cleveland-stype dot chart</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>WidthWS, <span class="at">y=</span>Location)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) </span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-9-1.png" width="80%" height="80%" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>WidthWS, <span class="at">y=</span>Location)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-9-2.png" width="80%" height="80%" /></p>
<p>Note the subtle difference produced by the use of the
<code>theme_bw()</code> term. The plots are basically x-y plots
(specified by the <code>aes(x=WidthWS, y=Location)</code> arguments),
with the points themselves added by the <code>geom_point()</code>
term.</p>
<p>An alternative version of this plot, and the one most frequently
used, can be constructed by sorting the rows of the data table. Sorting
can be tricky–it is easy to completely destroy a data set by sorting one
variable and not the others. It is often better to leave the data
unsorted, and to use an auxiliary variable (in this case
<code>index</code>) to record the rank-order of the variable being
plotted (in this case <code>WidthWS</code>), and the explicit
vector-element indexing of R (square brackets) to arrange the data in
the right order:</p>
<p>Here’s the dotchart, with rows ordered by the <code>WidthWS</code>
values:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># sorted dotchart</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">order</span>(WidthWS)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">dotchart</span>(WidthWS[index], <span class="at">labels=</span><span class="fu">as.character</span>(Location[index]), <span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-10-1.png" width="80%" height="80%" /></p>
<p>… and the <code>{ggplot2}</code> equivalent–note the use of the
<code>theme()</code> term to modify the label size:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Cleveland-style dot chart, reordered y variable</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>WidthWS, <span class="at">y=</span><span class="fu">reorder</span>(Location, WidthWS))) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>))</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-11-1.png" width="80%" height="80%" /></p>
</div>
<div id="boxplots" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Boxplots</h2>
<p>Summary plots display an object or a graph that gives a more concise
expression of the location, dispersion, and distribution of a variable
than an enumerative plot, but this comes at the expense of some loss of
information: In a summary plot, it is no longer possible to retrieve the
individual data value, but this loss is usually matched by the gain in
understanding that results from the efficient representation of the
data. Summary plots generally prove to be much better than the
enumerative plots in revealing the distribution of the data.</p>
<p>Boxplots are an example of a <em>univariate</em> and <em>summary</em>
plot. Here is the standard boxplot:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">boxplot</span>(WidthWS <span class="sc">~</span> HU, <span class="at">range=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-12-1.png" width="80%" height="80%" /></p>
<p>… and the <code>{ggplot2}</code> version:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># boxplot</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumcr, <span class="fu">aes</span>(<span class="at">x=</span>HU, <span class="at">y=</span>WidthWS)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-13-1.png" width="80%" height="80%" /></p>
<p>The actual data points can be added to the boxplot, by specifying an
additional graphical element using the <code>geom_point()</code>
function</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># ggplot box and points</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>HU, <span class="at">y=</span>WidthWS)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-14-1.png" width="80%" height="80%" /></p>
<p>Detach the <code>sumcr</code> dataframe.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># detach sumcr</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">detach</span>(sumcr)</span></code></pre></div>
</div>
<div id="histograms-and-density-plots" class="section level2"
number="2.4">
<h2><span class="header-section-number">2.4</span> Histograms and
density plots</h2>
<p>Histograms are a type of bar chart that displays the counts or
relative frequencies of values falling in different class intervals or
ranges. The overall impression one gets about the distribution of a
variable depends somewhat on the way the histogram is constructed: fewer
bars give a more generalized view, but may obscure details of the
distribution (the existence of a bimodal distribution, for example),
while more may not generalize enough.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># histograms</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># attach(specmap)</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">hist</span>(specmap<span class="sc">$</span>O18, <span class="at">breaks=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-16-1.png" width="80%" height="80%" /></p>
<p>Here’s the <code>{ggplot2}</code> version, with the biwidth specified
explicitly (e.g., 1.0)</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">ggplot</span>(specmap, <span class="fu">aes</span>(<span class="at">x =</span> O18)) <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">boundary =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-17-1.png" width="80%" height="80%" /></p>
<p>The look of a histogram depends a lot on the choice of bin-widths,
and the impression one may have about the distribution of the data is
influenced by the “spikiness” of the data. An alternative is the density
plot – a plot of the local relative frequency or density of points along
the number line or x-axis of a plot. The local density is determined by
summing the individual “kernel” densities for each point. Where points
occur more frequently, this sum, and consequently the local density,
will be greater. Density plots get around some of the problems that
histograms have, but still require some choices to be made. Here’s a
base-graphics density plot:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># density plots</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>O18_density <span class="ot">&lt;-</span> <span class="fu">density</span>(specmap<span class="sc">$</span>O18)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">plot</span>(O18_density)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-18-1.png" width="80%" height="80%" /></p>
<p>Note that in this example, an object <code>O18.density</code> is
created by the <code>density()</code> function, and then plotted using
the <code>plot()</code> function.</p>
<p>Here’s a version the <code>{ggplot2}</code> density plot:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(specmap, <span class="fu">aes</span>(<span class="at">x =</span> O18)) <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fl">0.0</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-19-1.png" width="80%" height="80%" /></p>
<p>A combined histogram, density and rug plot via the base graphics:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># histogram, density, rug</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">hist</span>(specmap<span class="sc">$</span>O18, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">lines</span>(O18_density)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">rug</span>(specmap<span class="sc">$</span>O18)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-20-1.png" width="80%" height="80%" /></p>
<p>And here’s a <code>ggplot</code> version, with three distinct
layers:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># histogram, density, rug</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">ggplot</span>(specmap, <span class="fu">aes</span>(<span class="at">x =</span> O18)) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">boundary =</span> <span class="fl">0.05</span>) <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">data =</span> specmap, <span class="fu">aes</span>(<span class="at">x =</span> O18)) </span></code></pre></div>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<p><img src="plots1_files/figure-html/plots1-21-1.png" width="80%" height="80%" /></p>
<p><a href="plots1.html">[Back to top]</a></p>
</div>
</div>
<div id="bivariate-plots" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Bivariate plots</h1>
<p>Bivariate descriptive displays or plots are designed to reveal the
relationship between two variables. As was the case when examining
single variables, there are several basic characteristics of the
relationship between two variables that are of interest. These
include:</p>
<ul>
<li>the <em>form</em> of the relationship</li>
<li>the <em>strength</em> of the relationship, and</li>
<li>the <em>dependence</em> of the relationship on external (to the two
variables being examined) circumstances.</li>
</ul>
<p>Bivariate plots provide the means for characterizing pair-wise
relationships between variables. Some simple extensions to such plots,
such as presenting multiple bivariate plots in a single diagram, or
labeling the points in a plot, allow simultaneous relationships among a
number of variables to be viewed.</p>
<div id="scatter-diagrams" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Scatter diagrams</h2>
<p>The scatter diagram is <em>the</em> workhourse diagram for looking at
relationships between variables (which is why it is the default plot
method in R). Also known as scatter plots or x-y plots, they are
<em>bivariate</em> (two variables) and <em>enumerative</em> (every point
shown). Traditionally the dependent or response variable is plotted on
the vertical or Y-axis, while the “independent or predictor variable is
plotted on the horizontal or X-axis. The convention can be imposed on
plots in by listing the horizontal or X-axis variable first, and Y-axis
variable second (i.e., an X-Y plots).</p>
<p>Here’s the base plot version of a scatter diagram:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># scatter plots</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co"># use Oregon climate-station data </span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="fu">attach</span>(orstationc)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="fu">plot</span>(elev,tann)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-22-1.png" width="80%" height="80%" /></p>
<p>… and here are two <code>{ggplot2}</code> scatter plots of annual
temperature and annual precipitation vs. elevation:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># ggplot2 scatter diagrams</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x =</span> elev, <span class="at">y =</span> tann)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-23-1.png" width="80%" height="80%" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x =</span> elev, <span class="at">y =</span> pann)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-23-2.png" width="80%" height="80%" /></p>
<p>It might make sense to compare the plots side-by-side. That can be
done for the <code>{ggplot2}</code> versions of those plots cby
generating the plots, saving them as objects (<code>plot1</code> and
<code>plot2</code>), and then using a function
<code>grid.arrange()</code> from the <code>gridExtra</code> package to
plot the two objects:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># side-by-side plots</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x =</span> elev, <span class="at">y =</span> tann)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x =</span> elev, <span class="at">y =</span> pann)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-24-1.png" width="80%" height="80%" /></p>
<p>Note that <code>{ggplot2}</code> allows one to transform the
coordinate system as well as the values of the individual variables.
Here a square-root scaling of the y-axis is done, to examine the
relationship between precipitation and elevation, when the precipitation
values have been transformed in an attempt to make the relationship more
linear. Note that the overall appearance of the plots is identical–it’s
the y-axes that differ.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># transformed y-axis</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x =</span> elev, <span class="at">y =</span> tann)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x =</span> elev, <span class="at">y =</span> pann)) <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">y=</span><span class="st">&quot;sqrt&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-25-1.png" width="80%" height="80%" /></p>
<p>Labeling of points using <code>ggplot</code> is possible, and again
<code>{ggplot2}</code> offers more fine control, such as some ability to
deal with text overlap.</p>
<p>Here is the base plotting version of a text-labelled scatter
plot:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># text labels</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">plot</span>(orstationc<span class="sc">$</span>tann <span class="sc">~</span> orstationc<span class="sc">$</span>elev, <span class="at">type=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="fu">text</span>(orstationc<span class="sc">$</span>tann <span class="sc">~</span> orstationc<span class="sc">$</span>elev, <span class="at">labels=</span><span class="fu">as.character</span>(orstationc<span class="sc">$</span>station), <span class="at">cex =</span> <span class="fl">0.8</span>) <span class="co"># text</span></span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-26-1.png" width="80%" height="80%" /></p>
<p>A <code>ggplot</code> version of the same ia shown below. The
<code>check_overlap()</code> function attempts to move the labels to
avoid overplotting. To see where the datapoints actualy lie, they are
added as dots.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># text labels</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x=</span> elev, <span class="at">y =</span> tann, <span class="at">label=</span><span class="fu">as.character</span>(station))) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="fu">theme_gray</span>()</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-27-1.png" width="80%" height="80%" /></p>
<p>Here’s another approach to point-labeling:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># text-label boxes</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x=</span> elev, <span class="at">y =</span> tann, <span class="at">label=</span><span class="fu">as.character</span>(station))) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="co"># geom_point(size = 1, color = &quot;red&quot;) +</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">theme_gray</span>()</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-28-1.png" width="80%" height="80%" /></p>
<p>Note the difference between the plots–the first plots a simple text
string using <code>geom_text()</code> while the second plots a more
formal label using <code>geom_label()</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># detach orstationc</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">detach</span>(orstationc)</span></code></pre></div>
</div>
<div id="summarizing-scatter-plots" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Summarizing scatter
plots</h2>
<p>Although the visual inspection of a scatter plot generally reveals
the nature of the relationship between the pair of variables being
plotted, sometimes this relationship may be obscured simply by the
number of points on the plot. In such cases the relationship, if
present, may be detected by a summarization method. Similarly, our
tendency to seek order in a chaotic set of points may lead us to
perceive a relationship where none is really there. Again, summarizing
the scatter plot may be useful.</p>
<p>Scatter plot smoothing involves fitting a smoothed curve through the
cloud of points to describe the general relationship between variables.
This technique is very generalizable, and a variety of smoothers can be
used. The most common is the “lowess” or “loess” smoother, which will be
discussed in more detail later.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># use Oregon climate station annual temperature data </span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">attach</span>(ortann)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="fu">plot</span>(elevation, tann)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(elevation,tann))</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-30-1.png" width="80%" height="80%" /></p>
<p>The <code>{ggplot2}</code> version uses <code>stat_smooth()</code> to
get the lowess curve (and confidence band):</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># ggplot scatter plot plus smooth</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ortann, <span class="fu">aes</span>(<span class="at">x =</span> elevation, <span class="at">y =</span> tann)) <span class="sc">+</span> </span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">span =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="plots1_files/figure-html/plots1-31-1.png" width="80%" height="80%" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">detach</span>(ortann)</span></code></pre></div>
<p><a href="plots1.html">[Back to top]</a></p>
</div>
</div>
<div id="multivariate-plots" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Multivariate plots</h1>
<p>Multivariate descriptive displays or plots are designed to reveal the
relationship among several variables simulataneously.. As was the case
when examining relationships among pairs of variables, there are several
basic characteristics of the relationship among sets of variables that
are of interest. These include:</p>
<ul>
<li>the <em>forms</em> of the relationships</li>
<li>the <em>strength</em> of the relationships, and</li>
<li>the <em>dependence</em> of the relationships on external (usually to
the pairs of variables being examined) circumstances.</li>
</ul>
<div id="labeled-scatter-plots" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Labeled scatter
plots</h2>
<p>In addition to the simple catagorial (or factor) labelling of plots,
the <code>{ggplot2}</code> package supports more elaborate, or computed,
decoration or coloring of plots, in order to examine the role of
additional variables on bivariate relationships. Annotation of points
involves adding information to a plot for individual points, that
include such things as the observation number or other information, to
“explain” individual points that may be unusual, or to simply identify
the point for a key observation or set of observations.</p>
<p>Here’s the base R version of the specmap data. Recall that the
relationship between ice volume and insolation anomalies (or differences
from the present day, which are considered to be the pacemake of the ice
ages) is weak when examined superficially.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># scatter plot</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="fu">attach</span>(specmap)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="fu">plot</span>(O18 <span class="sc">~</span> Insol, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-33-1.png" width="80%" height="80%" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">cor</span>(O18, Insol)</span></code></pre></div>
<pre><code>## [1] -0.2415094</code></pre>
<p>As we saw earlier, on approach is to look at the time series plot of
O18 values, and use insolation to colorize the individual points.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># points decorated by color</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="fu">library</span>(classInt) <span class="co"># class-interval recoding library</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co"># first block -- setup</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>plotvals <span class="ot">&lt;-</span> Insol</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>nclr <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>plotclr <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(nclr,<span class="st">&quot;PuOr&quot;</span>)</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>plotclr <span class="ot">&lt;-</span> plotclr[nclr<span class="sc">:</span><span class="dv">1</span>] <span class="co"># reorder colors</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(plotvals, nclr, <span class="at">style=</span><span class="st">&quot;quantile&quot;</span>)</span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>colcode <span class="ot">&lt;-</span> <span class="fu">findColours</span>(class, plotclr)</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a><span class="co"># second block -- plot</span></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a><span class="fu">plot</span>(O18 <span class="sc">~</span> Age, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">2.5</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a><span class="fu">points</span>(O18 <span class="sc">~</span> Age, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>colcode, <span class="at">cex=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-34-1.png" width="80%" height="80%" /></p>
<p>Here’s a <code>{ggplot2}</code> version, where the colorization is
extended to the lines as well as the symbols.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># points decoreated by color</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> specmap, <span class="fu">aes</span>(<span class="at">x=</span>Age, <span class="at">y=</span>O18, <span class="at">color=</span>Insol)) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> specmap, <span class="fu">aes</span>(<span class="at">x=</span>Age, <span class="at">y=</span>O18, <span class="at">color=</span>Insol), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>() <span class="sc">+</span> </span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>  <span class="fu">scale_colour_gradientn</span>(<span class="at">colours=</span><span class="fu">rev</span>(<span class="fu">brewer.pal</span>(nclr,<span class="st">&quot;PuOr&quot;</span>)))</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-35-1.png" width="80%" height="80%" /></p>
<p>As we saw earlier, positive insolation anomalies are associated with
trends toward lower ice volume (negative O18 values, note the y-axis
labelling), and negative anomalies with increasing ice volume.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">detach</span>(specmap)</span></code></pre></div>
<p>Symbol color and shape can be used to encode the values of two
additional variables, as demonstrated using the Summit Cr. data:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># points labeled by Reach and HU</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">attach</span>(sumcr)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="fu">plot</span>(WidthWS <span class="sc">~</span> CumLen, <span class="at">pch=</span><span class="fu">as.integer</span>(Reach), <span class="at">col=</span><span class="fu">as.integer</span>(HU))</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">25</span>, <span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;Reach A&quot;</span>, <span class="st">&quot;Reach B&quot;</span>, <span class="st">&quot;Reach C&quot;</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">650</span>, <span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;Glide&quot;</span>, <span class="st">&quot;Pool&quot;</span>, <span class="st">&quot;Riffle&quot;</span>), <span class="at">pch=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-37-1.png" width="80%" height="80%" /></p>
<p>Here is the <code>{ggplot2}</code> version:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># ggplot2 version</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>CumLen, <span class="at">y=</span>WidthWS, <span class="at">shape=</span>Reach, <span class="at">color=</span>HU)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-38-1.png" width="80%" height="80%" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># detach sumcr</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">detach</span>(sumcr)</span></code></pre></div>
<p>Symbol size can be used to indicate the value of a third variable,
forming a “bubble” or “balloon” plot, to indicate the value of station
elevation on a simple longitude by latitude plot of the Oregon
climate-station data:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># bubble plot</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">plot</span>(orstationc<span class="sc">$</span>lon, orstationc<span class="sc">$</span>lat, <span class="at">type=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a><span class="fu">symbols</span>(orstationc<span class="sc">$</span>lon, orstationc<span class="sc">$</span>lat, <span class="at">circles=</span>orstationc<span class="sc">$</span>elev, <span class="at">inches=</span><span class="fl">0.1</span>, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-40-1.png" width="80%" height="80%" /></p>
<p>Here’s the equivalent plot using <code>{ggplot2}</code></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># ggplot version</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> orcounty_sf, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> orstationc, <span class="fu">aes</span>(<span class="at">x=</span>lon, <span class="at">y=</span>lat, <span class="at">size=</span>elev), <span class="at">shape=</span><span class="dv">21</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">125</span>, <span class="sc">-</span><span class="dv">116</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">41</span>, <span class="dv">47</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-41-1.png" width="80%" height="80%" /></p>
</div>
<div id="d-scatter-plots" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> 3-D Scatter
plots</h2>
<p>3-D scatter plots (as distinct from scatter plot matrices involving
three variables), illustrate the relationship among three variables by
plotting them in a three-dimensional “workbox”. There are a number of
basic enhancements of the basic 3-D scatter plot, such as the addition
of drop lines, lines connecting points, symbol modification and so
on.</p>
<p>A 3-D point-cloud plot displays the values of three variables at a
time by plotting them in a 3-D “workbox” where the value of one variable
determines the relative position of the symbol along the X-axis and the
value of a second variable determines the relative position of the
symbol along the Y-axis, and the value of the third variable is used to
determine the relative position along the Z-axis. This plot makes use of
the <code>lattice</code> package.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># lattice 3-D cloud plot</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="fu">cloud</span>(orstationc<span class="sc">$</span>elev <span class="sc">~</span> orstationc<span class="sc">$</span>lon<span class="sc">*</span>orstationc<span class="sc">$</span>lat)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-42-1.png" width="80%" height="80%" /></p>
<p>Notice that you can still see the outline of the state, because
elevation is a fairly well behaved variable.</p>
<p>The <code>scatterplot3d</code> package (by Ligges and Mächler)
provides a way of constructing a 3-point cloud display with some nice
embellishments. The first part of the code, like in making maps, does
some setup like determining the number of colors to plot and getting
their definitions. The second block produces the plot.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># scatterplot3d</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">library</span>(scatterplot3d)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a><span class="co"># get colors for labeling the points</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>plotvar <span class="ot">&lt;-</span> orstationc<span class="sc">$</span>pann <span class="co"># pick a variable to plot</span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>nclr <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="co"># number of colors</span></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>plotclr <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(nclr,<span class="st">&quot;PuBu&quot;</span>) <span class="co"># get the colors</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>colornum <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="fu">rank</span>(plotvar), nclr, <span class="at">labels=</span><span class="cn">FALSE</span>)</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>colcode <span class="ot">&lt;-</span> plotclr[colornum] <span class="co"># assign color</span></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a><span class="co"># scatter plot</span></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>plot.angle <span class="ot">&lt;-</span> <span class="dv">45</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a><span class="fu">scatterplot3d</span>(orstationc<span class="sc">$</span>lon, orstationc<span class="sc">$</span>lat, plotvar, <span class="at">type=</span><span class="st">&quot;h&quot;</span>, <span class="at">angle=</span>plot.angle, <span class="at">color=</span>colcode, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex.symbols=</span><span class="dv">2</span>, </span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>  <span class="at">col.axis=</span><span class="st">&quot;gray&quot;</span>, <span class="at">col.grid=</span><span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-43-1.png" width="80%" height="80%" /></p>
<p>The z-variable, in this case, annual precipitation, is plotted as a
dot, and for interpretability a drop line is plotted below the dot. This
simple addition facilitates finding the location of each point (where it
hits the x-y, or latitude-longitude plane), as well as the value of
annual precipitation.</p>
<p>Maps can be added to the 3-D scatter plot to improve interpretab:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a><span class="co"># get points that define Oregon county outlines</span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a><span class="co"># oregon county outlines from {maps} package</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>or_map <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="st">&quot;county&quot;</span>, <span class="st">&quot;oregon&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">125</span>,<span class="sc">-</span><span class="dv">114</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">42</span>,<span class="dv">47</span>), <span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a><span class="co"># get colors for labeling the points</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>plotvar <span class="ot">&lt;-</span> orstationc<span class="sc">$</span>pann <span class="co"># pick a variable to plot</span></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>nclr <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="co"># number of colors</span></span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>plotclr <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(nclr,<span class="st">&quot;PuBu&quot;</span>) <span class="co"># get the colors</span></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>colornum <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="fu">rank</span>(plotvar), nclr, <span class="at">labels=</span><span class="cn">FALSE</span>)</span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>colcode <span class="ot">&lt;-</span> plotclr[colornum] <span class="co"># assign color</span></span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a><span class="co"># scatterplot and map</span></span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a>plot.angle <span class="ot">&lt;-</span> <span class="dv">135</span></span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a>s3d <span class="ot">&lt;-</span> <span class="fu">scatterplot3d</span>(orstationc<span class="sc">$</span>lon, orstationc<span class="sc">$</span>lat, plotvar, <span class="at">type=</span><span class="st">&quot;h&quot;</span>, <span class="at">angle=</span>plot.angle, <span class="at">color=</span>colcode, </span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a>            <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex.symbols=</span><span class="dv">2</span>, <span class="at">col.axis=</span><span class="st">&quot;gray&quot;</span>, <span class="at">col.grid=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a>s3d<span class="sc">$</span><span class="fu">points3d</span>(or_map<span class="sc">$</span>x,or_map<span class="sc">$</span>y,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(or_map<span class="sc">$</span>x)), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-44-1.png" width="80%" height="80%" /></p>
<p>The <code>map()</code> function generates the outlines of a map of
Oregon counties, and stores them in <code>or.map</code>, then the colors
are figured out, and finally a 3-D scatter plot is made (using the
<code>scatterplot3d()</code> function, and finally a 3-D scatter plot is
made (using the scatterplot3d() function, and the points and droplines
are added.</p>
<p><a href="plots1.html">[Back to top]</a></p>
</div>
</div>
<div id="trellislattice-graphics" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Trellis/Lattice
graphics</h1>
<p>Many data sets include a mixture of both “continuous” (ordinal-,
interval- or ratio-scale variables) and “discrete” (nominal-scale
variables). Often, the issue might arise of how a particular
relationship between variables might differ among groups. Information of
that nature can be gained using conditioning plots (or coplots). Such
plots are part of a general scheme of visual data analysis, known as
Trellis Graphics that has been created by the developers of the S
language. Trellis Graphics are implemented in R using the package
Lattice.</p>
<div id="coplots-conditioning-scatter-plots" class="section level2"
number="5.1">
<h2><span class="header-section-number">5.1</span> Coplots (conditioning
scatter plots)</h2>
<p>Conditioning scatter plots involves creating a multipanel display,
where each panel contains a subset of the data. This subset can be
either a) those observations that fall in a particular group, or b) they
may represent a the values that fall within a particular range of the
values of a variable. The idea is that the individual panels should
illustrate the relationship between a pair of variables, over part of
the range of the two marginal “conditioning” variables (i.e. the
relationship “conditional on one marginal variable lying in one
particular interval, and the other lying in a different interval.”)</p>
<p>Here is a coplot that describes the relationship between
water-surface width and depth, as it varies among reaches along Summit
Cr.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># coplot by Reach</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="fu">attach</span>(sumcr)</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a><span class="fu">coplot</span>(WidthWS <span class="sc">~</span> DepthWS <span class="sc">|</span> Reach, <span class="at">pch=</span><span class="dv">14</span><span class="sc">+</span><span class="fu">as.integer</span>(Reach), <span class="at">cex=</span><span class="fl">1.5</span>, </span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>       <span class="at">number=</span><span class="dv">3</span>, <span class="at">columns=</span><span class="dv">3</span>, <span class="at">overlap=</span><span class="dv">0</span>,</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>       <span class="at">panel=</span><span class="cf">function</span>(x,y,...) {</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>         <span class="fu">panel.smooth</span>(x,y,<span class="at">span=</span>.<span class="dv">8</span>,<span class="at">iter=</span><span class="dv">5</span>,...)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>         <span class="fu">abline</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>       } )</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-45-1.png" width="80%" height="80%" /></p>
<p>And here’s a <code>{ggplot2}</code> version:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># ggplot coplot</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>DepthWS, <span class="at">y=</span>WidthWS)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Reach) <span class="sc">+</span> </span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="plots1_files/figure-html/plots1-46-1.png" width="80%" height="80%" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># detach sumcr</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="fu">detach</span>(sumcr)</span></code></pre></div>
</div>
</div>
<div id="more-lattice-plots" class="section level1" number="6">
<h1><span class="header-section-number">6</span> More Lattice Plots</h1>
<p>“Trellis” plots are the R version of Lattice plots that were
originally implemented in the S language at Bell Labs. The aim of these
plots is to extend the usual kind of univariate and bivariate plots,
like histograms or scatter plots, to situations where some external
variables, possibly categorical or “factor” variables, may influence the
distribution of the data or form of a relationship. They do this by
generating a trellis or lattice of plots that consist of an array of
simple plots, arranged according to the values of some “conditioning”
variables.</p>
<div id="multipanel-plots" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Multipanel plots</h2>
<p>The following plots explore the seasonality of precipitation in the
Yellowstone region. This first plot uses glyphs to show the values of
twelve monthly precipitation variables as “spokes” of a wheel, where
each variable is plotted relative to its overall range. The first block
of code below sets things up, and the <code>stars()</code> function does
the plotting.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<pre><code>## Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">attach</span>(yellpratio)</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a><span class="co"># simple map</span></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="co"># read and plot shapefiles</span></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>ynp_state_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;/Users/bartlein/Documents/geog495/data/shp/ynpstate.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `ynpstate&#39; from data source `/Users/bartlein/Documents/geog495/data/shp/ynpstate.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 3 features and 1 field
## Geometry type: LINESTRING
## Dimension:     XY
## Bounding box:  xmin: -112.2967 ymin: 42.69208 xmax: -107.7095 ymax: 46.22544
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(ynp_state_sf))</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>ynprivers_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;/Users/bartlein/Documents/geog495/data/shp/ynprivers.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `ynprivers&#39; from data source `/Users/bartlein/Documents/geog495/data/shp/ynprivers.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 4 features and 1 field
## Geometry type: LINESTRING
## Dimension:     XY
## Bounding box:  xmin: -112.2967 ymin: 42.69208 xmax: -107.7095 ymax: 46.22544
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(ynprivers_sf), <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>ynplk_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;/Users/bartlein/Documents/geog495/data/shp/ynplk.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `ynplk&#39; from data source `/Users/bartlein/Documents/geog495/data/shp/ynplk.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 1 feature and 1 field
## Geometry type: LINESTRING
## Dimension:     XY
## Bounding box:  xmin: -110.566 ymin: 44.29883 xmax: -110.1902 ymax: 44.56021
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(ynplk_sf), <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="fu">points</span>(Lon, Lat, <span class="at">pch=</span><span class="dv">3</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a><span class="co"># stars plot for precipitation ratios</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>col.red <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;red&quot;</span>,<span class="fu">length</span>(orstationc[,<span class="dv">1</span>]))</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a><span class="fu">stars</span>(yellpratio[,<span class="dv">4</span><span class="sc">:</span><span class="dv">15</span>], <span class="at">locations=</span><span class="fu">as.matrix</span>(<span class="fu">cbind</span>(Lon, Lat)),</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a><span class="at">col.stars=</span>col.red, <span class="at">len=</span><span class="fl">0.2</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">key.loc=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">111.5</span>,<span class="fl">42.5</span>), <span class="at">labels=</span><span class="cn">NULL</span>, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-48-1.png" width="80%" height="80%" /></p>
<p>Here the stars wind up looking more like fans. The legend indicates
that stations with fans that open out to the right are stations with
winter precipitation maxima (like in the southwestern portion of the
region) while those that open toward the left have summer precipitation
maxima (like in the southeastern portion of the region).</p>
<p>The next examples show a couple of conditioning plots (coplots), that
illustrate the relationship between January and July precipitation, as
varies (is conditioned on) with elevation. The first block of code does
some set up.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co"># create some conditioning variables</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>Elevation <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(Elev,<span class="dv">4</span>,.<span class="dv">25</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>Latitude <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(Lat,<span class="dv">2</span>,.<span class="dv">25</span>)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>Longitude <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(Lon,<span class="dv">2</span>,.<span class="dv">25</span>)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a><span class="co"># January vs July Precipitation Ratios by Elevation</span></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(APJan <span class="sc">~</span> APJul <span class="sc">|</span> Elevation,</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>    <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>        <span class="fu">panel.grid</span>(<span class="at">v=</span><span class="dv">2</span>)</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>        <span class="fu">panel.xyplot</span>(x, y)</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>        <span class="fu">panel.loess</span>(x, y, <span class="at">span =</span> <span class="fl">1.0</span>, <span class="at">degree =</span> <span class="dv">1</span>, <span class="at">family=</span><span class="st">&quot;symmetric&quot;</span>)</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>        <span class="fu">panel.abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>    },</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;APJul&quot;</span>,</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;APJan&quot;</span>)</span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a><span class="fu">print</span>(plot2, <span class="at">position=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">375</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">more=</span>T)</span>
<span id="cb64-18"><a href="#cb64-18" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">plot</span>(Elevation), <span class="at">position=</span><span class="fu">c</span>(.<span class="dv">1</span>,<span class="fl">0.0</span>,.<span class="dv">9</span>,.<span class="dv">4</span>))</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-49-1.png" width="80%" height="80%" /></p>
<p>The plot shows that the relationship between January and July
precipitation indeed varies with elevation. At low elevations, there is
proportionally lower January precipitation for the same July values
(lower two panels on the lattice plot), but at higher elevations, there
is proportionally more (top two panels). This relationship points to
some orographic (i.e. related to the elevation of the mountains)
amplification of the winter precipitation.</p>
<p>Here’s a <code>{ggplot2}</code> version:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># create an elevation zones factor</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>yellpratio<span class="sc">$</span>Elev_zones <span class="ot">&lt;-</span> <span class="fu">cut</span>(Elevation, <span class="dv">4</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Elev1 (lowest)&quot;</span>, <span class="st">&quot;Elev2&quot;</span>, <span class="st">&quot;Elev3&quot;</span>, <span class="st">&quot;Elev4 (highest)&quot;</span>))</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a><span class="fu">ggplot</span>(yellpratio, <span class="fu">aes</span>(<span class="at">x=</span>APJul, <span class="at">y=</span>APJan)) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Elev_zones)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="plots1_files/figure-html/plots1-50-1.png" width="80%" height="80%" /></p>
<p>The next plot shows the variation of the relationship between January
and July precipitation as it varies spatially.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="co"># January vs July Precipitation Ratios by Latitude and Longitude</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(APJan <span class="sc">~</span> APJul <span class="sc">|</span> Latitude<span class="sc">*</span>Longitude,</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>    <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>        <span class="fu">panel.grid</span>(<span class="at">v=</span><span class="dv">2</span>)</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>        <span class="fu">panel.xyplot</span>(x, y)</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>        <span class="fu">panel.loess</span>(x, y, <span class="at">span =</span> .<span class="dv">8</span>, <span class="at">degree =</span> <span class="dv">1</span>, <span class="at">family=</span><span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>        <span class="fu">panel.abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>    },</span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;APJul&quot;</span>,</span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;APJan&quot;</span>)</span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a><span class="fu">print</span>(plot3)</span></code></pre></div>
<p><img src="plots1_files/figure-html/plots1-51-1.png" width="80%" height="80%" /></p>
<p>Notice that the steepest curve lies in the panel representing the
southwestern part of the region (low latitude and low longitude,
i.e. the bottom left panel), which suggests that winter (January)
precipitation is relatively more import there, which is also apparent on
the stars plot above.</p>
<p>Here’s the <code>{ggplot2}</code> version:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># create conditioning variables</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>Loc_factor <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(yellpratio<span class="sc">$</span>Lat))</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>Loc_factor[(yellpratio<span class="sc">$</span>Lat <span class="sc">&gt;=</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lat) <span class="sc">&amp;</span> yellpratio<span class="sc">$</span>Lon <span class="sc">&lt;</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lon))] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>Loc_factor[(yellpratio<span class="sc">$</span>Lat <span class="sc">&gt;=</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lat) <span class="sc">&amp;</span> yellpratio<span class="sc">$</span>Lon <span class="sc">&gt;=</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lon))] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>Loc_factor[(yellpratio<span class="sc">$</span>Lat <span class="sc">&lt;</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lat) <span class="sc">&amp;</span> yellpratio<span class="sc">$</span>Lon <span class="sc">&lt;</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lon))] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>Loc_factor[(yellpratio<span class="sc">$</span>Lat <span class="sc">&lt;</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lat) <span class="sc">&amp;</span> yellpratio<span class="sc">$</span>Lon <span class="sc">&gt;=</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lon))] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a><span class="co"># convert to factor, and add level lables</span></span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>yellpratio<span class="sc">$</span>Loc_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Loc_factor)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a><span class="fu">levels</span>(yellpratio<span class="sc">$</span>Loc_factor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Low Lon/High Lat&quot;</span>, <span class="st">&quot;High Lon/High Lat&quot;</span>, <span class="st">&quot;Low Lon/Low Lat&quot;</span>, <span class="st">&quot;High Lon/Low Lat&quot;</span>)</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a><span class="fu">ggplot</span>(yellpratio, <span class="fu">aes</span>(<span class="at">x=</span>APJul, <span class="at">y=</span>APJan)) <span class="sc">+</span></span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">span =</span> <span class="fl">0.9</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Loc_factor)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="plots1_files/figure-html/plots1-52-1.png" width="80%" height="80%" /></p>
<p><a href="plots1.html">[Back to top]</a></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
