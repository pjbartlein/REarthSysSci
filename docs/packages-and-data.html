<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Packages and data</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>







<link rel="stylesheet" href="html-md-01.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R for Earth-System Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture topics</li>
    <li>
      <a href="intro.html">Introduction: R, RStudio, and other infrastructure</a>
    </li>
    <li>
      <a href="usingR.html">Using R</a>
    </li>
    <li>
      <a href="ESSdata.html">Earth-system science data</a>
    </li>
    <li>
      <a href="netCDF.html">netCDF in R</a>
    </li>
    <li>
      <a href="raster_intro.html">raster, terra, and netCDF in R</a>
    </li>
    <li>
      <a href="plots1.html">Plots (1)</a>
    </li>
    <li>
      <a href="plots1.html">Plots (2)</a>
    </li>
    <li>
      <a href="maps1.html">Maps (1)</a>
    </li>
    <li>
      <a href="maps21.html">Maps (2)</a>
    </li>
    <li>
      <a href="geospatial.html">Geospatial analyses</a>
    </li>
    <li>
      <a href="correlation.html">Correlation and regression</a>
    </li>
    <li>
      <a href="prediction.html">Prediction</a>
    </li>
    <li>
      <a href="pca.html">PCA</a>
    </li>
    <li>
      <a href="svd.html">Singular Value Decomposistion</a>
    </li>
    <li>
      <a href="highdim.html">High-resolution &amp; high-dimensional data</a>
    </li>
    <li>
      <a href="multivariate.html">Multivariate methods</a>
    </li>
    <li>
      <a href="timeseries.html">Time-series analysis</a>
    </li>
    <li>
      <a href="otherlang.html">Other Languages</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tasks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Tasks</li>
    <li>
      <a href="installR.html">Install R and RStudio</a>
    </li>
    <li>
      <a href="Ex_UsingR.html">Using R exercise</a>
    </li>
    <li>
      <a href="install_netCDF.html">Install netCDF &amp; Panoply</a>
    </li>
    <li>
      <a href="transfer.html">File transfer</a>
    </li>
    <li>
      <a href="texteditor.html">Install a text editor</a>
    </li>
    <li>
      <a href="dataselection.html">Project data set selection</a>
    </li>
    <li>
      <a href="markdown.html">Markdown and RMarkdown</a>
    </li>
    <li>
      <a href="pandoc.html">Pandoc</a>
    </li>
    <li>
      <a href="GitHub.html">GitHub and UO pages.uoregon.edu</a>
    </li>
    <li>
      <a href="localweb.html">Local websites</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="readings.html">Readings</a>
    </li>
    <li>
      <a href="websites.html">Old course web pages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Packages and data</h1>

</div>


<p>
<span style="color: #00cc00;">NOTE: This page has been revised for
Winter 2024, but may undergo further edits.</span>
</p>
<div
id="installing-r-packages-loading-a-saved-workspace-and-creating-rstudio-projects"
class="section level2">
<h2>Installing R Packages, Loading a saved Workspace, and creating
RStudio Projects</h2>
<p><strong>1. Introduction</strong></p>
<p>Several things are covered in this document:</p>
<ol style="list-style-type: decimal">
<li>some basic setting up that needs to be done on Windows;</li>
<li>installation of a single R package using the Windows and Mac Console
command line, GUIs, or RStudio;</li>
<li>“batch” installation of the packages required for doing the
exercises and illustrating the lectures;</li>
<li>loading a saved workspace that includes the data necessary for
completing the exercises; and</li>
<li>setting up an RStudio “project”.</li>
</ol>
<p>Note that you will need to be connected to the Internet to download
the various packages and data sets, and be sure to notice the
<strong>Warning</strong> about deleting the contents of the workspace in
section 6 below.</p>
<p><strong>2. Initial set-up on Windows</strong></p>
<p>Because Windows objects to the idea of programs installing files into
the <code>C:\Program Files</code> folder, R will run into trouble when
it attempts to install add-in packages there. The most reliable
work-around seems to be to create what’s known as a “personal library”
where the packages are stored. The R GUI for Windows and RStudio will
generally offer to create one the first time you download a package (see
the examples below), but Windows sometimes does not get the permissions
entirely correct. The best thing to do is to create the folder yourself
before downloading a package the first time, i.e., create the folder</p>
<p><code>c:\Users\bartlein\AppData\Local\R\win-library\4.3\</code></p>
<p>using Windows Explorer (the file manager, not Internet Explorer, the
web browser), where <code>username</code> is your specific Windows user
name. Use Windows Explorer to browse to your
<code>\AppData\Local\`` folder and successively create the sub-folders</code><code>,</code>-library<code>, and</code>\4.3<code>. (Later, when you update R to a new version (e.g. R 4.4.0) you can create another new personal library folder named, for example,</code>C:-library\4.4`,
move the old packages there, and then use R or RStudio to update
them.)</p>
<p><strong>3. Installing a single package</strong></p>
<p>Much of the time only a single package must be installed. In those
instances, using the Console command line, or RStudio is quite
efficient. The following illustrates several different ways that, for
example, the <code>sf</code> or “simple features” package can be
installed.</p>
<p>The various ways of running R (Windows or Mac OS X/macOS GUIs,
RStudio) all have in common the simple Console command-line approach,
where the following can be typed in or copied to the “Console” window
(<em>Note that the package name here must be surrounded by
quotes</em>):</p>
<pre><code>install.packages(&quot;sf&quot;)</code></pre>
<p>On Windows, this approach requires that the “personal library”
described above has been set up, and on both Windows and Mac OS X/MacOS,
and that the “binary” or pre-built packages are actually available in a
repository like CRAN.</p>
<p>NOTE: The base packages of R are updated every few months or so, and
sometimes there may be a delay of a few days or even a month before the
individual packages “catch up”. More about that below.</p>
<p><em>Windows (R GUI)</em></p>
<p>In the R for Windows GUI, packages can be installed at the Console
command line, or through the Packages &gt; Install package(s) menu. That
latter choice produces a long list of packages that must be scrolled
through, which is why the direct Console command-line approach works
better. If the “personal library” file has been set up correctly, then
typing or copying <code>install.packages("sp")</code> to the Console
command line should work without a problem. If the library was not
correctly created, R will respond with the following:</p>
<pre><code>## install.packages(&quot;sf&quot;)
## trying URL &#39;https://cran.rstudio.com/bin/macosx/big-sur-x86_64/contrib/4.3/sf_1.0-14.tgz&#39;
## Content type &#39;application/x-gzip&#39; length 91103299 bytes (86.9 MB)
## ==================================================
## downloaded 86.9 MB

## The downloaded binary packages are in
##  /var/folders/_z/00grn4pd407dtnp256rd81k00000gp/T//Rtmp4Tsroj/downloaded_packages</code></pre>
<p>This message indicates that the personal library file hadn’t been
created earlier. R will immediately pop up two dialog boxes, one after
the other:</p>
<ol style="list-style-type: decimal">
<li>Would you like to use a personal library instead?`<br />
</li>
<li>Would you like to create a personal library
<code>'C:\Users\bartlein\Documents\R\win-library\4.0'</code> to install
packages into?</li>
</ol>
<p>Respond yes to both.</p>
<p>The first time a package is installed, R may want to know which “CRAN
Mirror” you want to use. The “generic” one, sponsored by RStudio is <a
href="https://cloud.r-project.org/">https://cloud.r-project.org/</a> and
if the message
<code>--- Please select a CRAN mirror for use in this session ---</code>
appears, select <code>cloud.r-project.org</code>. In RStudio, on the
<code>Tools</code> &gt; <code>Global Options</code> &gt;
<code>Packages</code> tab, you can select
<code>Global (CDN) - RStudio</code>.</p>
<p>and something like the following confirmation should appear:</p>
<pre><code>## trying URL &#39;http://cran.r-project.org/bin/macosx/el-capitan/contrib/4.0/sp_1.4-5.tgz&#39; 
## Content type &#39;application/x-gzip&#39; length 1884204 bytes (1.8 MB)
## ==================================================
## downloaded 1.8 MB

## The downloaded binary packages are in
##  /var/folders/p7/mp5dt52n7x5fnjyw74bqxvcm0000gp/T//Rtmp4i8uhB/downloaded_packages</code></pre>
<p>The message indicates that the “personal library” folder was created,
and the <code>sp</code> package was successfully downloaded.</p>
<p>(The first time a package is installed, R may want to know which
“CRAN Mirror” you want to use. The “generic” one, sponsored by RStudio
is <a
href="https://cloud.r-project.org/">https://cloud.r-project.org/</a> and
if the message
<code>--- Please select a CRAN mirror for use in this session ---</code>
appears, select <code>cloud.r-project.org</code>. In RStudio, on the
<code>Tools</code> &gt; <code>Global Options</code> &gt;
<code>Packages</code> tab, you can select
<code>Global (CDN) - RStudio</code>.)</p>
<p><em>RStudio on Windows</em></p>
<p>In RStudio, the Console command-line approach works the same as in
the Windows R GUI, and usually simply installs the package, but it may
also respond as follows:</p>
<pre><code>## Error in install.packages : missing value where TRUE/FALSE needed</code></pre>
<p>If that happens, quit RStudio and try again. Note that if RStudio
occupies the whole screen, the individual questions about creating the
library may be hidden.</p>
<p>You can also use the Tools &gt; Install packages… menu. If the
personal library does not exist, the following message will appear</p>
<pre><code>## Would you like to create a personal library &#39;C:\Users\bartlein\Documents\R\win-library\4.0&#39; 
## to install packages into?  </code></pre>
<p>Reply yes, and select or type in the following in the dialog box that
appears:</p>
<ol style="list-style-type: decimal">
<li>Install from: <code>Repository (CRAN)</code><br />
</li>
<li>Packages: <code>sp</code><br />
</li>
<li>Install to Library:
<code>C:\Users\bartlein\Documents\R\win-library\4.0 (Default)</code></li>
<li>Make sure “install dependencies” is checked</li>
</ol>
<p>You should get a confirmation as before.</p>
<p><em>RStudio on Mac OS X, macOS</em></p>
<p>In RStudio running on the Mac, the Tools &gt; Install Packages menu
brings up a dialog box. Select or type in the following in the dialog
box:</p>
<ol style="list-style-type: decimal">
<li>Install from: <code>Repository (CRAN)</code><br />
</li>
<li>Packages: <code>sp</code><br />
</li>
<li>Install to Library:
<code>/Volumes/Macintosh HD/Library/Frameworks/R.framework/Resources/library [Default]</code></li>
<li><strong>This is important:</strong> Make sure “Install dependencies”
is checked.</li>
</ol>
<p>After clicking on install, you should get a confirmation like the one
just above.</p>
<p><em>RStudio in general</em></p>
<p>One of the “window panes” in RStudio can be configured to have a
“Packages” tab, which reveals a nice list of the packages that have been
installed, and indicates with a check mark the packages that are
currently loaded (via the <code>library()</code> function). There is
also a convenient “Update” button in the display.</p>
<p><strong>4. Updating packages</strong></p>
<p>R packages are continuously being updated or revised, and from time
to time it’s a good idea to refresh the currently installed packages.
There are various ways of doing this, but the simplest is to type or
copy the following to the Console:</p>
<pre><code>update.packages()</code></pre>
<p>Note that here as elsewhere, the <code>update.packages</code>
function needs be accompanied by the parentheses,
i.e. <code>update.packages()</code>, even though the “argument” of the
function is null.</p>
<p><strong>5. Installation of multiple packages at a time</strong></p>
<p>It’s possible to use the various GUIs to install more than one
package at time, but this most conveniently done via the Console command
line. The following packages are among those that will be used to run
the code in the lectures:</p>
<p><code>sp</code>, <code>car</code>, <code>cluster</code>,
<code>corrplot</code>, <code>fields</code>, <code>gam</code>,
<code>ggplot2</code>, <code>gridExtra</code>, <code>iplots</code>,
<code>leaps</code>, <code>maps</code>, <code>maptools</code>,
<code>maptree</code>, <code>mapview</code>, <code>mvtsplot</code>,
<code>ncdf4</code>, <code>psych</code>, <code>qgraph</code>,
<code>raster</code>, <code>rasterVis</code>, <code>RColorBrewer</code>,
<code>rgdal</code>, <code>rgeos</code>, <code>rgl</code>,
<code>rJava</code>, <code>scatterplot3d</code>, <code>sf</code>,
<code>sp</code>, <code>spdep</code>, <code>tidyverse</code>,
<code>tree</code></p>
<p>These packages can be installed as a group (<em>but note that this
will take a while</em>) by copying and pasting the two lines of code to
the Console command line <strong>one line at at time</strong> :</p>
<pre><code>url_string &lt;- &quot;https://pjbartlein.github.io/GeogDataAnalysis/R/sources/install-packages.R.txt&quot;</code></pre>
<p>and then</p>
<pre><code>source(url_string)</code></pre>
<p>This procedure first assigns the URL of a file on GitHub, a
single-line R script that includes the <code>install.packages()</code>
function with a list of packages as its argument, and then the
<code>source(url)</code> function executes that script. The contents of
the file can be seen by clicking on the following link <a
href="https://pjbartlein.github.io/GeogDataAnalysis/R/sources/install-packages.R.txt">install-packages.R.txt</a>.
Many more packages will actually be installed than appear in that list
because “dependencies” (or other packages that the packages being
installed use) are also installed. If R complains about attempting to
update packages that are already loaded, reply “No” to the dialog asking
whether or not to resart R.</p>
<p>At the time of this writing, the “source” versions of several of the
spatial packages are newer than binary versions. R will indicate
something like</p>
<pre><code>## There is a binary version available but the source version is later:
##     binary source needs_compilation
## sp     1.2-5  1.2-6              TRUE

## Do you want to install from sources the packages which need compilation?
## y/n: </code></pre>
<p><strong>Reply no.</strong> “Building” these packages locally, or
finding and downloading prebuilt binaries is not straightforward at
first, and for the things we do in lectures and exercises it will
probably be fine to use the older versions.</p>
<p>There are additional packages, like <code>lattice</code> and
<code>MASS</code>, that are “built-into” R which do not need to be
specifically installed (but which can be updated as above).</p>
<p><strong>6. Downloading a workspace</strong></p>
<p>After a while, it gets tedious to download one at a time the
individual spreadsheet and shape files used in the exercises. You can
load a copy of a workspace that contains most of the data used in the
class by doing the following:</p>
<p>First, clear the workspace:</p>
<pre><code>rm(list=ls(all=TRUE))</code></pre>
<p><strong>WARNING: This will indeed remove everything in the current
workspace.</strong> That will be ok, unless you’re in the middle of an
exercise. Then, enter the following, which uses a “connection” to
download data from a URL:</p>
<pre><code>con &lt;- url(&quot;https://pjbartlein.github.io/GeogDataAnalysis/data/Rdata/geog495.RData&quot;)
load(file=con)
close(con)</code></pre>
<p>Note that this workspace will overwrite the existing one. You can
check its contents using <code>ls()</code>. This workspace contains the
shape files that are used in the exercises, so if you load it, you won’t
have to download and read in the individual shape file components.</p>
<p><strong>7. RStudio Projects</strong></p>
<p>RStudio “Projects” are collections of workspaces, history files, and
source documents (e.g. <code>.R</code> and <code>.Rmd</code> files)
along with a specific working directory that make it easy to separate
individual projects (in the sense of different tasks, e.g. exercises for
GEOG 4/595, thesis project work, individual field study data sets,
etc.). The RStudio Support documentation on creating and using projects
is very clear on how to do these tasks:</p>
<ul>
<li><a
href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects</a></li>
</ul>
<p>You can set up a Project in your existing working directory by:</p>
<ul>
<li>finding your current working directory using
<code>getwd()</code></li>
<li>clicking on File &gt;</li>
<li>clicking on <code>Existing Directory</code></li>
<li>browsing to the working diretory, and</li>
<li>clicking on <code>Create Project</code>.</li>
</ul>
<p>RStudio can then be launched by clicking on the <code>.Rproj</code>
file in your working directory.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
